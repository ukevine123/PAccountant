@using Application.DTO
@using Application.Interfaces
@inject IAssetService AssetService
@inject ISnackbar Snackbar

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">Add New Asset</MudText>
    </TitleContent>
    <DialogContent>
        <EditForm Model="Model" OnValidSubmit="OnValidSubmit">
            <DataAnnotationsValidator />
            <MudGrid>
                <MudItem xs="12">
                    <MudTextField Label="Name" @bind-Value="Model.Name" For="@(() => Model.Name)" Variant="Variant.Outlined" />
                </MudItem>
                <MudItem xs="12">
                    <MudTextField Label="Type" @bind-Value="Model.Type" For="@(() => Model.Type)" Variant="Variant.Outlined" />
                </MudItem>
                <MudItem xs="12">
                    <MudNumericField Label="Value" @bind-Value="Model.Value" For="@(() => Model.Value)" Variant="Variant.Outlined" />
                </MudItem>
            </MudGrid>
            <div class="d-flex justify-end mt-4">
                <MudButton OnClick="Cancel" Class="ml-auto">Cancel</MudButton>
                <MudButton ButtonType="ButtonType.Submit" Color="Color.Primary" Variant="Variant.Filled" Class="ml-2">Save</MudButton>
            </div>
        </EditForm>
    </DialogContent>
</MudDialog>

@code {
    [CascadingParameter] 
    IMudDialogInstance MudDialog { get; set; } = default!;

    private AssetCreateDTO Model { get; set; } = new();

    private void OnValidSubmit()
    {
        AssetService.CreateAsset(Model);
        Snackbar.Add("Asset created successfully!", Severity.Success);
        MudDialog.Close(DialogResult.Ok(true));
    }
      private void Cancel() => MudDialog.Cancel();
}